<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Carte d'événement</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  <style>
    /* Style global pour la carte */
    .event-card {
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      border-radius: 10px;
      overflow: hidden;
      background-color: #fff;
    }

    /* Effet de survol */
    .event-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
    }

    /* Image de la carte */
    .card-img-top {
      object-fit: cover;
      height: 200px;
      transition: opacity 0.3s ease;
      background-color: #f0f0f0; /* Placeholder pour le chargement */
    }

    .event-card:hover .card-img-top {
      opacity: 0.9;
    }

    /* Corps de la carte */
    .card-body {
      padding: 1.5rem;
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    /* Titre de la carte */
    .card-title {
      font-size: 1.25rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
    }

    /* Texte de la carte */
    .card-text {
      font-size: 0.9rem;
      color: #6c757d;
      line-height: 1.4;
    }

    /* Boutons */
    .btn {
      font-size: 0.85rem;
      padding: 0.5rem 1rem;
      border-radius: 5px;
      transition: background-color 0.3s ease, transform 0.2s ease;
    }

    .btn:hover {
      transform: scale(1.05);
    }

    .btn-primary {
      background-color: #007bff;
      border-color: #007bff;
    }

    .btn-warning {
      background-color: #ffc107;
      border-color: #ffc107;
    }

    .btn-danger {
      background-color: #dc3545;
      border-color: #dc3545;
    }

    .btn-danger:disabled {
      background-color: #e57373;
      border-color: #e57373;
      cursor: not-allowed;
    }

    /* Icônes */
    .bi {
      font-size: 1rem;
      vertical-align: middle;
    }

    /* Texte tronqué pour la description */
    .text-truncate {
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    /* Badge pour état "Complet" */
    .badge-complet {
      font-size: 0.8rem;
      padding: 0.4rem 0.8rem;
    }

    /* Responsive design */
    @media (max-width: 576px) {
      .event-card {
        margin-bottom: 1.5rem;
      }

      .card-title {
        font-size: 1.1rem;
      }

      .btn {
        font-size: 0.8rem;
        padding: 0.4rem 0.8rem;
      }

      .card-body {
        padding: 1rem;
      }
    }
  </style>
</head>
<body>
  <div *ngIf="e.title === searchValue || searchValue == null">
    <div class="card h-100 shadow-sm event-card" ngHover>
      <div class="position-relative">
        <img
          src="{{ e.imageUrl }}"
          class="card-img-top img-fluid"
          alt="{{ e.title }}"
          style="height: 200px; object-fit: cover;"
        />
        <span
          *ngIf="e.nbPlaces == 0"
          class="badge bg-danger position-absolute top-0 end-0 m-2 badge-complet"
        >
          Complet
        </span>
      </div>
      <div class="card-body d-flex flex-column">
        <h5
          class="card-title"
          [ngStyle]="{'color': e.nbPlaces == 0 ? 'red' : 'green'}"
        >
          {{ e.title }}
        </h5>
        <p class="text-muted mb-1">
          <i class="bi bi-geo-alt me-1"></i>{{ e.location }}
        </p>
        <p class="text-muted mb-1">
          <i class="bi bi-wallet2 me-1"></i>{{ e.price | euro }}
        </p>
        <p class="fw-bold mb-1">
          <i class="bi bi-ticket me-1"></i>{{ e.nbPlaces }} places restantes
        </p>
        <p class="card-text text-truncate">{{ e.description }}</p>
        <div class="d-flex justify-content-between align-items-center mt-auto">
          <button
            [ngClass]="{
              'btn': true,
              'btn-sm': true,
              'btn-primary': e.nbrLike >= 5,
              'btn-warning': e.nbrLike < 5
            }"
            (click)="likeEvent(e)"
            aria-label="Like event"
          >
            <i class="bi bi-hand-thumbs-up me-1"></i>Like {{ e.nbrLike }}
          </button>
          <button
            class="btn btn-sm btn-danger"
            [disabled]="e.nbPlaces == 0"
            (click)="nbrPlaceDecr(e)"
            aria-label="Buy ticket"
          >
            <i class="bi bi-cart me-1"></i>Buy Ticket
          </button>
        </div>
        <div class="mt-2 d-flex justify-content-between align-items-center">
          <span class="text-muted">
            <i class="bi bi-calendar me-1"></i>{{ e.date | date: 'shortDate' }}
          </span>
          <a [routerLink]="['./details', e.id]" class="text-primary">
            More Details
          </a>
        </div>
      </div>
    </div>
  </div>
</body>
</html>